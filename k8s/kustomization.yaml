# k8s/kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Specifies the namespace for all resources in this kustomization.
namespace: todo-app

# Lists the resource files that Kustomize will manage.
# Note: secret.yaml and configmap.yaml are not listed here because
# they will be generated by Kustomize's secretGenerator and configMapGenerator.
resources:
  - namespace.yaml
  - deployment.yaml
  - service.yaml
  - ingress.yaml

# Generates the todo-app-secret.
# Kustomize will automatically base64 encode these literal values.
# IMPORTANT: Replace placeholder values with your actual plain text credentials.
secretGenerator:
  - name: todo-app-secret
    envs:
      - secrets.env # Create a secrets.env file (e.g., DB_PASSWORD=yourpass)

# Generates the todo-app-config.
configMapGenerator:
  - name: todo-app-config
    envs:
      - configs.env # Create a configs.env file (e.g., DB_HOST=my-db)

# Adds common labels to all resources managed by this Kustomization.
commonLabels:
  app.kubernetes.io/name: todo-app
  app.kubernetes.io/instance: todo-app-instance
  app.kubernetes.io/version: "1.0.0" # Example, adjust as needed
  app.kubernetes.io/component: application
  app.kubernetes.io/part-of: todo-application
  app.kubernetes.io/managed-by: kustomize

# You can also manage image tags, replicas, etc., across your resources.
# Example for image tags (uncomment and adjust if needed):
images:
  - name: your-dockerhub-username/todo-app # This is the image name used in deployment.yaml
    newName: your-dockerhub-username/todo-app # Placeholder: Will be replaced by CI/CD
    newTag: latest # Placeholder: Will be replaced by CI/CD